{"version":3,"file":"author-control.es5.js","sources":["../src/element.js"],"sourcesContent":["class AuthorFormControlElement extends AuthorBaseElement(HTMLElement) {\n  constructor () {\n    super(`{{TEMPLATE-STRING}}`)\n\n    this.UTIL.defineAttributes({\n      type: ''\n    })\n\n    this.UTIL.defineProperties({\n      initialized: {\n        private: true,\n        default: false\n      },\n\n      initialValue: {\n        default: null\n      },\n\n      labels: {\n        readonly: true,\n        get: () => this.PRIVATE.labelElements\n      },\n\n      labelElements: {\n        private: true,\n        default: []\n      },\n\n      datalist: {\n        readonly: true,\n        get: () => this.PRIVATE.datalistElement\n      },\n\n      datalistElement: {\n        private: true,\n        default: null\n      },\n\n      datalistSourceElement: {\n        private: true,\n        default: null\n      },\n\n      input: {\n        readonly: true,\n        get: () => this.PRIVATE.inputElement\n      },\n\n      inputElement: {\n        private: true,\n        default: null\n      },\n\n      inputSourceElement: {\n        private: true,\n        default: null\n      },\n\n      fieldInputTypes: {\n        readonly: true,\n        private: true,\n        default: [\n          'color',\n          'date',\n          'datetime-local',\n          'email',\n          'file',\n          'hidden',\n          'image',\n          'month',\n          'number',\n          'password',\n          'range',\n          'reset',\n          'search',\n          'submit',\n          'tel',\n          'text',\n          'time',\n          'url',\n          'week',\n          'textarea'\n        ]\n      },\n\n      toggleInputTypes: {\n        readonly: true,\n        private: true,\n        default: [\n          'checkbox',\n          'radio'\n        ],\n      },\n\n      supportedTypes: {\n        readonly: true,\n        private: true,\n        default: [\n          'field',\n          'toggle',\n          'select'\n        ]\n      }\n    })\n\n    this.UTIL.definePrivateMethods({\n      catalogChild: node => {\n        switch (node.nodeName) {\n          case 'LABEL':\n            node.htmlFor = this.PRIVATE.guid\n            this.PRIVATE.labelElements.push(node)\n            return\n\n          case 'INPUT':\n          case 'TEXTAREA':\n            node.id = this.PRIVATE.guid\n            this.PRIVATE.inputSourceElement = node\n            return\n\n          case 'SELECT':\n            this.PRIVATE.inputSourceElement = node\n            return\n\n          case 'DATALIST':\n            this.PRIVATE.datalistSourceElement = node\n            return\n\n          default: if (node.children.length > 0) {\n            return Array.from(node.children).forEach(child => this.PRIVATE.catalogChild(child))\n          }\n        }\n      },\n\n      init: () => {\n        this.initialValue = this.PRIVATE.inputSourceElement.value\n\n        switch (this.PRIVATE.inputSourceElement.nodeName) {\n          case 'INPUT':\n            this.PRIVATE.inputElement = this.PRIVATE.inputSourceElement\n\n            if (this.PRIVATE.datalistSourceElement) {\n              this.type = 'datalist'\n\n              if (!customElements.get('author-datalist')) {\n                this.PRIVATE.initDefaultDatalist()\n                break\n              }\n\n              this.PRIVATE.initAuthorDatalist()\n\n            } else if (this.PRIVATE.fieldInputTypes.indexOf(this.PRIVATE.inputElement.type) >= 0) {\n              this.type = 'field'\n            } else if (this.PRIVATE.toggleInputTypes.indexOf(this.PRIVATE.inputElement.type) >= 0) {\n              this.type = 'toggle'\n            }\n\n            break\n\n          case 'TEXTAREA':\n            this.PRIVATE.inputElement = this.PRIVATE.inputSourceElement\n            this.type = 'textarea'\n            break\n\n          case 'SELECT':\n            this.type = 'select'\n\n            if (!customElements.get('author-select')) {\n              this.PRIVATE.initDefaultSelect()\n              break\n            }\n\n            this.PRIVATE.initAuthorSelect()\n            break\n        }\n\n        this.PRIVATE.initialized = true\n        this.emit('initialized')\n      },\n\n      initAuthorDatalist: () => {\n        let { datalistSourceElement, inputElement, guid } = this.PRIVATE\n\n        let authorDatalist = document.createElement('author-datalist')\n\n        Array.from(datalistSourceElement.attributes).forEach(attr => {\n          if (attr.specified) {\n            authorDatalist.setAttribute(attr.name, attr.value)\n\n            if (attr.name === 'autofocus') {\n              datalistSourceElement.removeAttribute(attr.name)\n            }\n          }\n        })\n\n        this.removeChild(inputElement)\n\n        // Use a select as sourceElement to preserve option indexes, since\n        // datalist doesn't assign indexes to child options\n        let surrogate = document.createElement('select')\n        Array.from(datalistSourceElement.children).forEach(option => surrogate.add(option))\n        surrogate.selectedIndex = -1\n\n        authorDatalist.inject(inputElement, surrogate, guid)\n        this.replaceChild(authorDatalist, datalistSourceElement)\n        this.PRIVATE.inputElement = authorDatalist\n      },\n\n      initDefaultDatalist: () => {\n        let { datalistSourceElement, inputElement, guid } = this.PRIVATE\n\n        datalistSourceElement.id = `${guid}_datalist`\n        inputElement.setAttribute('list', datalistSourceElement.id)\n\n        this.PRIVATE.datalistElement = datalistSourceElement\n      },\n\n      initDefaultSelect: () => {\n        let { inputSourceElement } = this.PRIVATE\n\n        inputSourceElement.id = this.PRIVATE.guid\n        inputSourceElement.setAttribute('role', 'menu')\n\n        this.PRIVATE.inputElement = inputSourceElement\n      },\n\n      initAuthorSelect: () => {\n        let { inputSourceElement } = this.PRIVATE\n        let authorSelect = document.createElement('author-select')\n\n        authorSelect.id = this.PRIVATE.guid\n\n        Array.from(inputSourceElement.attributes).forEach(attr => {\n          if (attr.specified) {\n            authorSelect.setAttribute(attr.name, attr.value)\n\n            if (attr.name === 'autofocus') {\n              inputSourceElement.removeAttribute(attr.name)\n            }\n          }\n        })\n\n        authorSelect.inject(inputSourceElement, this.labels)\n\n        this.replaceChild(authorSelect, inputSourceElement)\n        this.PRIVATE.inputElement = authorSelect\n\n        // This is required for label clicks to focus author-select\n        this.labels.forEach(label => {\n          this.UTIL.registerListener(label, 'click', evt => this.PRIVATE.inputElement.focus())\n        })\n      }\n    })\n\n    this.UTIL.registerListeners(this, {\n      connected: () => this.PRIVATE.guid = this.UTIL.generateGuid('control_'),\n      rendered: () => {\n        Array.from(this.children).forEach(child => this.PRIVATE.catalogChild(child))\n        this.PRIVATE.init()\n      }\n    })\n  }\n\n  static get observedAttributes () {\n    return ['disabled']\n  }\n}\n\ncustomElements.define('author-control', AuthorFormControlElement)\n\nexport default AuthorFormControlElement\n"],"names":["super","this","let"],"mappings":"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"}