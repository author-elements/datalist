{"version":3,"file":"author-datalist.es5.js","sources":["../src/element.js"],"sourcesContent":["class AuthorDatalistElement extends AuthorMenuElement {\n  constructor () {\n    super(`{{TEMPLATE-STRING}}`)\n\n    this.UTIL.defineAttributes({\n      'case-sensitive': false\n    })\n\n    this.UTIL.definePrivateMethods({\n      hideAllOptions: () => Array.from(this.options).forEach(option => option.setAttribute('hidden', '')),\n\n      inputFocusHandler: evt => {\n        this.inputElement.addEventListener('keydown', this.PRIVATE.inputKeydownHandler)\n      },\n\n      clearFilter: () => {\n        if (this.optionsElement.hasFilter('query')) {\n          this.optionsElement.removeFilter('query')\n          this.selectedIndex = -1\n        }\n      },\n\n      filterInput: () => {\n        this.PRIVATE.clearFilter()\n\n        let query = this.inputElement.value\n\n        if (!query || query === '') {\n          this.PRIVATE.showAllOptions()\n          return this.PRIVATE.clearFilter()\n        }\n\n        this.optionsElement.addFilter('query', () => {\n          let results = this.optionsElement.find(query, this['case-sensitive'])\n\n          if (results.length) {\n            return results\n          }\n\n          return this.options\n        })\n\n        this.PRIVATE.hideAllOptions()\n\n        if (this.optionsElement.filteredOptions.length > 0) {\n          this.optionsElement.filteredOptions.forEach(option => option.hidden = false)\n          this.open = true\n        } else {\n          this.open = false\n        }\n      },\n\n      inputKeydownHandler: evt => {\n        switch (evt[this.keySource]) {\n          case 13:\n          case 'Enter':\n          case 27:\n          case 'Escape':\n          case 38:\n          case 'ArrowUp':\n          case 40:\n          case 'ArrowDown': break\n\n          case 32:\n          case ' ': return\n\n          case 8:\n          case 'Backspace':\n            if (this.inputElement.value.length === 1) {\n              this.open = false\n            }\n\n            break\n        }\n\n        this.PRIVATE.keydownHandler(evt)\n      },\n\n      showAllOptions: () => Array.from(this.options).forEach(option => option.removeAttribute('hidden'))\n    })\n\n    this.UTIL.registerListeners(this, {\n      connected: () => {\n        this.UTIL.registerListeners(this.inputElement, {\n          focus: this.PRIVATE.inputFocusHandler,\n\n          blur: evt => {\n            this.inputElement.removeEventListener('keydown', this.PRIVATE.inputKeydownHandler)\n          },\n\n          click: evt => this.open = true,\n\n          input: this.PRIVATE.filterInput\n        })\n\n        this.UTIL.registerListeners(window, {\n          scroll: evt => this.open = false\n        })\n      },\n\n      'options.selected': evt => {\n        let option = evt.detail.options[0]\n        this.inputElement.value = option.value\n        this.PRIVATE.filterInput()\n        this.emit('option.selected', option.displayElement)\n      }\n    })\n  }\n\n  static get observedAttributes () {\n    return [...AuthorMenuElement.observedAttributes, 'case-sensitive']\n  }\n\n  get value () {\n    return this.inputElement.value\n  }\n\n  add (option, index) {\n    this.optionsElement.addOption(option, index)\n  }\n\n  clear () {\n    this.inputElement.value = ''\n    this.PRIVATE.showAllOptions()\n  }\n\n  focus () {\n    this.inputElement.focus()\n  }\n\n  inject (input, select, guid) {\n    // Prevent re-injections\n    if (this.PRIVATE.injected) {\n      return\n    }\n\n    input.slot = 'input'\n    input.id = guid\n\n    this.UTIL.defineProperty('inputElement', {\n      readonly: true,\n      default: input\n    })\n\n    this.appendChild(this.inputElement)\n    super.inject(select)\n  }\n}\n\ncustomElements.define('author-datalist', AuthorDatalistElement)\n\nexport default AuthorDatalistElement\n"],"names":["AuthorDatalistElement","UTIL","defineAttributes","definePrivateMethods","hideAllOptions","Array","from","options","forEach","option","setAttribute","inputFocusHandler","evt","inputElement","addEventListener","PRIVATE","inputKeydownHandler","clearFilter","optionsElement","hasFilter","removeFilter","selectedIndex","filterInput","query","value","showAllOptions","addFilter","results","find","length","filteredOptions","hidden","open","keySource","keydownHandler","removeAttribute","registerListeners","connected","focus","blur","removeEventListener","click","input","window","scroll","detail","emit","displayElement","index","addOption","select","guid","injected","slot","id","defineProperty","readonly","default","appendChild","AuthorMenuElement","observedAttributes","customElements","define"],"mappings":"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"}